## 이미지 사전 로딩

### 느린 이미지 로딩

![image](https://github.com/user-attachments/assets/493eb076-badb-4dc0-97ac-60a0c6226574)

처음 모달을 클릭하면 이미지가 제때 뜨지 않는 문제 발생!

**모달을 띄우고 그 안에 이미지를 로드**하려는데, 이미지의 사이즈가 크다 보니 다운로드 시간이 오래 걸려서 다운로드가 완료될 때까지 아무것도 뜨지 X

### 이미지 사전 로딩

컴포넌트는 import 함수를 이용하여 로드

이미지는 **이미지가 화면에 그려지는 시점**, 즉 **HTML 또는 CSS에서 이미지를 사용하는 시점에 로드**

=> 이런 경우 외에 **자바스크립트로 이미지를 직접 로드하는 방법**이 존재

=> **자바스크립트의 Image 객체를 사용**

```javascript
const img = new Image();
img.src = "{이미지주소}";
```

new 연산자를 이용해 Image 객체를 생성한 후, 생성된 인스턴스의 src 속성에 원하는 이미지의 주소를 입력해 해당 이미지를 로딩

모달을 사전로드하는 타이밍에 모달에서 가장 먼저 보이는 이미지를 넣어준다

```javascript
useEffect(() => {
  const component = import("./components/ImageModal");
  const img = new Image();
  img.src = "{모달 첫번째 이미지 주소}";
}, []);
```

![image](https://github.com/user-attachments/assets/42e580cb-5ea8-4b2e-bec3-1d24215d3b12)

페이지가 로드되는 과정을 살펴보면, **모달 코드와 함께 이미지가 다운로드!**

=> 나중에 모달위에 포시될 대표 이미지를 미리 다운로드

> 테스트 할 때 주의할 점
>
> 'Disable cache' 옵션을 체크 해제
>
> => **이미지를 로드할 때 브라우저가 해당 이미지를 캐싱**해 두기 때문에 이미지 사전 로딩이 가능
>
> => 해당 옵션이 체크되어 있으면 이미지 리소스에 대해 캐시를 하지 않아 매번 새롭게 불러온다
>
> 하지만, 캐시를 활성화하면 다른 리소스도 캐시를 사용하므로 정확한 분석이 어렵
>
> 따라서 새로고침할 때 일반 새로고침 X, 캐시 비우기 및 강력 새로고침

![image](https://github.com/user-attachments/assets/85ce4045-d887-48e5-aabf-663fc734821c)

**사전 로드한 이미지의 Size 항목에 disk cache**라고 적혀있고, 다운로드한 시간이 매우 짧다

=> **페이지가 로드된 후 이미지를 사전 로드**했기 때문

몇장의 이미지를 사전로딩해야 할까?

여러 장의 이미지를 사전로딩할 수 있지만 그렇게 하면 페이지가 로드 될 때, **사전 로딩을 하는 순간 브라우저의 리소스를 그만큼 많이 사용하기 때문에 다른 성능 문제를 야기**

=> 어떤 콘텐츠를 사전 로드할 때는 정말 사전 로딩이 필요한 지 고민이 필요함
