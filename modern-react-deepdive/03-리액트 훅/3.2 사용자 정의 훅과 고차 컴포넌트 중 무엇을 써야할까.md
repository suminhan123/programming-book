# 3.2 사용자 정의 훅과 고차 컴포넌트 중 무엇을 써야 할까

재사용할 수 있는 로직을 관리할 수 있는 방법으로는 **사용자 정의 훅**과 **고차 컴포넌트**가 있다

## 3.2.1 사용자 정의 훅

서로 다른 컴포넌트 내부에서 같은 로직을 공유하고자 할 때 주로 사용되는 것이 사용자 정의 훅

리액트의 훅의 이름은 use로 시작한다는 규칙이 있음
=> 사용자 정의 훅도 규칙 준수해 해당 함수가 리액트 훅이라는 것을 바로 인식 가능

- HTTP 요청을 하는 fetch 를 기반으로 한 사용자 정의 훅

```typescript
function useFetch<T>(
  url: string,
  { method, body }: { method: string; body?: XMLHttpRequestBodyInit }
) {
  const [result, setResult] = useState<T | undefined>();
  const [isLoading, setIsLoading] = useState<boolean>(false);
  const [ok, setOk] = useState<boolean | undefined>();
  const [status, setStatus] = useState<number | undefined>();

  useEffect(() => {
    const abortController = new AbortController();

    (async () => {
      setIsLoading(true);

      const response = await fetch(url, {
        method,
        body,
        signal: abortController.signal,
      });

      setOk(response.ok);
      setStatus(response.status);

      if (response.ok) {
        const apiResult = await response.json();
        setResult(apiResult);
      }

      setIsLoading(false);
    })();

    return () => {
      abortController.abort();
    };
  }, [ok, result, isLoading, status]);

  return { ok, result, isLoading, status };
}
```

```typescript
interface Todo {
  userId: number;
  id: number;
  title: string;
  completed: boolean;
}

export default function App() {
  const { isLoading, result, status, ok } = useFetch<Array<Todo>>(
    "https:'---",
    { method: "GET" }
  );

  useEffect(() => {
    if (!isLoading) {
      console.log("Fetch Result >>", status);
    }
  }, [status, isLoading]);

  return (
    <div>
      {ok
        ? (result || []).map(({ userId, title }, index) => (
            <div key={index}>
              <p>{title}</p>
            </div>
          ))
        : null}
    </div>
  );
}
```

훅으로 분리하지 않았다면 fetch로 API 호출을 해야 하는 모든 컴포넌트 내에서 공통적으로 관리되지 않는 최소 4개의 state 를 선언해서 각각 구현했어야 한다..!
=> useFetch 훅만을 사용해 손쉽게 중복되는 로직을 관리!!

사용자 정의 훅은 내부에 useState 와 useEffect 등을 가지고 자신만의 원하는 훅을 만드는 기법으로, 내부에서 useState 를 사용했기 때문에 리액트 훅의 규칙을 따라서 use로 시작하는 이름을 가져야 한다
