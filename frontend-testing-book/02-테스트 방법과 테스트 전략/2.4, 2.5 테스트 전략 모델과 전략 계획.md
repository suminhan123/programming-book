## 2.4 테스트 전략 모델

- E2E 테스트
- 통합 테스트
- 단위 테스트

위로 갈수록 **실제 제품과 유사한 테스트가 가능**하다 하지만 그만큼 **많인 시간과 비용이 필요**

=> 테스트용 데이터베이스 서버를 준비하는 등 실제 환경과 최대한 유사한 환경을 구축해야 하고 테스트 할 때마다 제품과 연동된 외부 시스템의 응답도 기다려야 한다

지금부터 비용 분배 최적화에 참고할 수 있는 테스트 전략 모델을 살펴보자

### 아이스트림 콘과 테스트 피라미드

![image](https://github.com/user-attachments/assets/d4aeb174-8742-42b9-8fbb-2fa8fc903111)

**상층부의 테스트의 비중이 높은 아이스트림 콘**은 안티패턴으로 자주 언급되는 테스트 전략 모델

=> 운용 비용이 높을 뿐만 아니라 외부 모듈의 의존성 때문에 가끔 실패하는 불안정한 테스트가 많다

모든 테스트가 통과하는데 오래 걸린다면 개발 흐름에 나쁜 영향

더 나은 개발 환경을 만들고자 테스트를 자동화한 것이 오히려 개발 경험을 해칠 수 있다

**실행 시간을 줄이려고 실행 빈도를 줄이면 테스트 자동화의 신뢰성은 낮아진다**

<br />

![image](https://github.com/user-attachments/assets/3beae07d-39a5-40ec-b2b2-e85677ac4445)

**하층부 테스트의 비중이 높을 수록 더욱 안정적이고 가성비 높은 테스트가 가능**하다는 것이 **테스트 피라미드**의 핵심이다

브라우저를 포함하는 상층부 테스트는 실행시간이 길어 신속성이 떨어진다

하층부 테스트는 실행시간이 짧아 신송성이 높고 안정성도 높다

### 테스팅 트로피

![image](https://github.com/user-attachments/assets/f156db4c-d062-4408-ae2c-c2d112457e53)

테스팅 트로피의 핵심은 **통합 테스팅의 비중이 가장 높아야 한다**

개발에서 단일 UI 컴포넌트로 구현되는 기능은 거의 없다

=> 버튼을 클릭하면 외부 api 를 호출하는 등 **여러 컴포넌트의 조합**으로 이루어진다

또한 **사용자의 인터렉션에서 기능이 시작**된다

=> 사용자 조작을 기점으로 한 통합 테스트의 비중이 높을 수록 더욱 우수한 테스트 전략이라는 의도가 있다

## 2.5 테스트 전략 계획

테스트 전략 모델을 참고해 프로젝트에 최적인 전략을 수립하려면 테스트 대상 및 목적에 따른 판단 기준을 정립해야 한다

### 테스트가 없어 리팩토링이 불안한 경우

릴리스된 프로젝트에 테스트 코드가 없으면 리팩토링이 불안

릴리스된 기능을 목록으로 정리

=> 정리가 됐다면 변경 전 후 **결함이 발생하지 않았는지 검증하는 회귀 테스트를 작성**

웹 api 서버에 대한 의존성이 깔끔하게 분리되지 X 테스트 작성이 어렵다

=> **mock 서버를 활용**하여 **통합 테스트를 실시**

=> mock 서버를 이용하면 구현 코드를 수정하지 않아도 테스트할 수 있어 리팩토링 전에 테스트를 작성할 때 유용 (릴리스 프로젝트에 효과적)

### 반응형으로 제작된 프로젝트

하나의 HTML에 여러 형태의 화면을 제공한다

하나의 파일로 여러 화면을 제공하면 PC용 디자인만 수정하려고 했으나 모바일 디자인까지 수정되는 상황이 발생

=> 스타일을 포함한 세밀한 테스트를 위해 CSS가 적용된 렌더링 결과를 검증할 브라우저 테스트가 필요

=> 이때 실행하는 테스트가 **브라우저를 사용한 시각적 회귀 테스트**!!

**스토리북**은 UI 컴포넌트 단위로 시각적 회귀 테스트가 가능

### 데이터 베이스를 포함한 E2E 테스트가 필요한 경우

mock 서버가 아닌 실제 웹 api 를 사용해서 E2E 테스트를 하고 싶다면 **테스트용 스테이징 환경을 사용**

스테이징 환경이란 실제로 배포할 환경에 가까운 형태로 만든 테스트용 환경

스테이징 환경을 만들지 않고 실시할 수 있는 테스트 자동화 방법도 있다

=> 테스트할 시스템을 컨테이너화해 CI환경에서 실행한 후 연동 중인 여러 시스템과 함께 테스트하는 것
